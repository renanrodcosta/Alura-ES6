{"version":3,"sources":["../../app-es6/controllers/NegociacaoController_exercicio_post.js"],"names":["NegociacaoController_exercicio_post","$","document","querySelector","bind","_ultimoCriterioOrdem","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","event","preventDefault","negociacoesService","NegociacoesService","negociacao","_criaNegociacao","gravar","_criarModelPost","then","adiciona","texto","_limpaFormulario","catch","erro","error","Promise","all","obterNegociacoesSemana","obterNegociacoesSemanaAnterior","obterNegociacoesSemanaRetrasada","negociacoes","reduce","arrayAchatado","array","concat","forEach","coluna","inverteOrdem","ordena","a","b","esvazia","Negociacao","DataHelper","textoParaData","value","data","quantidade","valor","focus"],"mappings":"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","file":"NegociacaoController_exercicio_post.js","sourcesContent":["class NegociacaoController_exercicio_post{\r\n\r\n    constructor() {\r\n        let $ = document.querySelector.bind(document)\r\n\r\n        this._ultimoCriterioOrdem = ''\r\n\r\n        this._inputData = $(\"#data\")\r\n        this._inputQuantidade = $(\"#quantidade\")\r\n        this._inputValor = $(\"#valor\")\r\n\r\n        this._listaNegociacoes = new Bind(new ListaNegociacoes(), \r\n                                          new NegociacoesView($(\"#negociacoesView\")), \r\n                                          'adiciona', 'esvazia', 'ordena', 'inverteOrdem')\r\n\r\n        this._mensagem = new Bind(new Mensagem(), new MensagemView($(\"#mensagemView\")), 'texto')\r\n    }\r\n\r\n    adicionar(event){\r\n        event.preventDefault()  \r\n\r\n        try {\r\n            let negociacoesService = new NegociacoesService()\r\n\r\n            let negociacao = this._criaNegociacao()\r\n\r\n            negociacoesService.gravar(this._criarModelPost(negociacao))\r\n                .then(() => {\r\n                    this._listaNegociacoes.adiciona(negociacao)\r\n                    this._mensagem.texto = \"Negociação incluida com sucesso!\"\r\n                    this._limpaFormulario()\r\n                })  \r\n                .catch(erro => this._mensagem.texto = erro)\r\n        } catch (error) {\r\n            this._mensagem.texto = error\r\n        }                       \r\n    }\r\n\r\n    importar(){\r\n        let negociacoesService = new NegociacoesService()\r\n\r\n        Promise.all([   \r\n            negociacoesService.obterNegociacoesSemana(), \r\n            negociacoesService.obterNegociacoesSemanaAnterior(), \r\n            negociacoesService.obterNegociacoesSemanaRetrasada()])\r\n        .then(negociacoes => {  \r\n            negociacoes\r\n                .reduce((arrayAchatado, array) => arrayAchatado.concat(array), [])\r\n                .forEach(negociacao => this._listaNegociacoes.adiciona(negociacao))\r\n            this._mensagem.texto = \"Negociações importadas com sucesso\"\r\n        })\r\n        .catch(erro => this._mensagem.texto = erro)\r\n    }\r\n\r\n    ordenar(coluna){\r\n        if(coluna == this._ultimoCriterioOrdem){\r\n            this._listaNegociacoes.inverteOrdem()\r\n        } else {\r\n            this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna])\r\n        }\r\n        this._ultimoCriterioOrdem = coluna\r\n    }\r\n\r\n    apagar(){\r\n        this._listaNegociacoes.esvazia()\r\n        this._mensagem.texto = \"Negociações apagadas com sucesso!\"\r\n    }\r\n\r\n    _criaNegociacao(){\r\n        return new Negociacao(DataHelper.textoParaData(this._inputData.value),\r\n                                        this._inputQuantidade.value,\r\n                                        this._inputValor.value)\r\n    }\r\n\r\n    _criarModelPost(negociacao){\r\n        return {\r\n            \"data\" : negociacao.data,\r\n            \"quantidade\" : negociacao.quantidade,\r\n            \"valor\" : negociacao.valor\r\n        }\r\n    }\r\n\r\n    _limpaFormulario(){\r\n        this._inputData.value = '';\r\n        this._inputQuantidade.value = 1;\r\n        this._inputValor.value = 0.0;\r\n        this._inputData.focus();\r\n    }\r\n}"]}