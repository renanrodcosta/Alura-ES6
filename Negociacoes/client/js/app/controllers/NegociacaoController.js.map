{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["ListaNegociacoes","Mensagem","NegociacoesView","MensagemView","NegociacoesService","DataHelper","Bind","Negociacao","NegociacaoController","$","document","querySelector","bind","_ultimoCriterioOrdem","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_service","_init","event","preventDefault","negociacao","_criaNegociacao","cadastra","then","adiciona","texto","mensagem","_limpaFormulario","catch","erro","importa","negociacoes","forEach","coluna","inverteOrdem","ordena","a","b","apaga","esvazia","textoParaData","value","parseInt","parseFloat","data","quantidade","valor","focus","lista","setInterval","importar"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import {ListaNegociacoes} from '../models/ListaNegociacoes.js'\r\nimport {Mensagem} from '../models/Mensagem.js'\r\nimport {NegociacoesView} from '../views/NegociacoesView.js'\r\nimport {MensagemView} from '../views/MensagemView.js'\r\nimport {NegociacoesService} from '../services/NegociacoesService.js'\r\nimport {DataHelper} from '../helpers/DataHelper.js'\r\nimport {Bind} from '../helpers/Bind.js'\r\nimport {Negociacao} from '../models/Negociacao.js'\r\n\r\nexport class NegociacaoController{\r\n\r\n    constructor() {\r\n        let $ = document.querySelector.bind(document)\r\n\r\n        this._ultimoCriterioOrdem = ''\r\n\r\n        this._inputData = $(\"#data\")\r\n        this._inputQuantidade = $(\"#quantidade\")\r\n        this._inputValor = $(\"#valor\")\r\n\r\n        this._listaNegociacoes = new Bind(new ListaNegociacoes(), \r\n                                          new NegociacoesView($(\"#negociacoesView\")), \r\n                                          'adiciona', 'esvazia', 'ordena', 'inverteOrdem')\r\n\r\n        this._mensagem = new Bind(new Mensagem(), new MensagemView($(\"#mensagemView\")), 'texto')\r\n\r\n        this._service = new NegociacoesService()\r\n\r\n        this._init()\r\n    }\r\n\r\n    adicionar(event){\r\n        event.preventDefault()  \r\n\r\n         let negociacao = this._criaNegociacao();\r\n\r\n        this._service\r\n            .cadastra(negociacao)\r\n            .then(mensagem => {\r\n                this._listaNegociacoes.adiciona(negociacao);\r\n                this._mensagem.texto = mensagem; \r\n                this._limpaFormulario();  \r\n            }).catch(erro => this._mensagem.texto = erro);                \r\n    }\r\n\r\n    importar(){\r\n        this._service\r\n            .importa(this._listaNegociacoes.negociacoes)\r\n            .then(negociacoes => {\r\n                negociacoes.forEach(negociacao => this._listaNegociacoes.adiciona(negociacao))\r\n                this._mensagem.texto = \"Negociações importadas com sucesso\"\r\n            })\r\n            .catch(erro => this._mensagem.texto = erro)\r\n    }\r\n\r\n    ordenar(coluna){\r\n        if(coluna == this._ultimoCriterioOrdem){\r\n            this._listaNegociacoes.inverteOrdem()\r\n        } else {\r\n            this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna])\r\n        }\r\n        this._ultimoCriterioOrdem = coluna\r\n    }\r\n\r\n    apagar(){\r\n        this._service.apaga()\r\n            .then(mensagem => {\r\n                this._listaNegociacoes.esvazia()\r\n                this._mensagem.texto = mensagem\r\n            })\r\n            .catch(erro => this._mensagem.texto = erro)\r\n    }\r\n\r\n    _criaNegociacao(){\r\n        return new Negociacao(DataHelper.textoParaData(this._inputData.value),\r\n                                        parseInt(this._inputQuantidade.value),\r\n                                        parseFloat(this._inputValor.value))\r\n    }\r\n\r\n    _criarModelPost(negociacao){\r\n        return {\r\n            \"data\" : negociacao.data,\r\n            \"quantidade\" : negociacao.quantidade,\r\n            \"valor\" : negociacao.valor\r\n        }\r\n    }\r\n\r\n    _limpaFormulario(){\r\n        this._inputData.value = '';\r\n        this._inputQuantidade.value = 1;\r\n        this._inputValor.value = 0.0;\r\n        this._inputData.focus();\r\n    }\r\n\r\n    _init(){\r\n        this._service\r\n            .lista()\r\n            .then(negociacoes => \r\n                        negociacoes.forEach(negociacao => \r\n                            this._listaNegociacoes.adiciona(negociacao)))\r\n            .catch(erro => this._mensagem.texto = erro)\r\n        \r\n        setInterval(() => {\r\n            this.importar()\r\n        }, 3000)\r\n    }\r\n}"]}