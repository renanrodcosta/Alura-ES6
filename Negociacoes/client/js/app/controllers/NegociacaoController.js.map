{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_ultimoCriterioOrdem","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_service","NegociacoesService","_init","event","preventDefault","negociacao","_criaNegociacao","cadastra","then","adiciona","texto","mensagem","_limpaFormulario","catch","erro","importa","negociacoes","forEach","coluna","inverteOrdem","ordena","a","b","apaga","esvazia","Negociacao","DataHelper","textoParaData","value","parseInt","parseFloat","data","quantidade","valor","focus","lista","setInterval","importar"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController{\r\n\r\n    constructor() {\r\n        let $ = document.querySelector.bind(document)\r\n\r\n        this._ultimoCriterioOrdem = ''\r\n\r\n        this._inputData = $(\"#data\")\r\n        this._inputQuantidade = $(\"#quantidade\")\r\n        this._inputValor = $(\"#valor\")\r\n\r\n        this._listaNegociacoes = new Bind(new ListaNegociacoes(), \r\n                                          new NegociacoesView($(\"#negociacoesView\")), \r\n                                          'adiciona', 'esvazia', 'ordena', 'inverteOrdem')\r\n\r\n        this._mensagem = new Bind(new Mensagem(), new MensagemView($(\"#mensagemView\")), 'texto')\r\n\r\n        this._service = new NegociacoesService()\r\n\r\n        this._init()\r\n    }\r\n\r\n    adicionar(event){\r\n        event.preventDefault()  \r\n\r\n         let negociacao = this._criaNegociacao();\r\n\r\n        this._service\r\n            .cadastra(negociacao)\r\n            .then(mensagem => {\r\n                this._listaNegociacoes.adiciona(negociacao);\r\n                this._mensagem.texto = mensagem; \r\n                this._limpaFormulario();  \r\n            }).catch(erro => this._mensagem.texto = erro);                \r\n    }\r\n\r\n    importar(){\r\n        this._service\r\n            .importa(this._listaNegociacoes.negociacoes)\r\n            .then(negociacoes => {\r\n                negociacoes.forEach(negociacao => this._listaNegociacoes.adiciona(negociacao))\r\n                this._mensagem.texto = \"Negociações importadas com sucesso\"\r\n            })\r\n            .catch(erro => this._mensagem.texto = erro)\r\n    }\r\n\r\n    ordenar(coluna){\r\n        if(coluna == this._ultimoCriterioOrdem){\r\n            this._listaNegociacoes.inverteOrdem()\r\n        } else {\r\n            this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna])\r\n        }\r\n        this._ultimoCriterioOrdem = coluna\r\n    }\r\n\r\n    apagar(){\r\n        this._service.apaga()\r\n            .then(mensagem => {\r\n                this._listaNegociacoes.esvazia()\r\n                this._mensagem.texto = mensagem\r\n            })\r\n            .catch(erro => this._mensagem.texto = erro)\r\n    }\r\n\r\n    _criaNegociacao(){\r\n        return new Negociacao(DataHelper.textoParaData(this._inputData.value),\r\n                                        parseInt(this._inputQuantidade.value),\r\n                                        parseFloat(this._inputValor.value))\r\n    }\r\n\r\n    _criarModelPost(negociacao){\r\n        return {\r\n            \"data\" : negociacao.data,\r\n            \"quantidade\" : negociacao.quantidade,\r\n            \"valor\" : negociacao.valor\r\n        }\r\n    }\r\n\r\n    _limpaFormulario(){\r\n        this._inputData.value = '';\r\n        this._inputQuantidade.value = 1;\r\n        this._inputValor.value = 0.0;\r\n        this._inputData.focus();\r\n    }\r\n\r\n    _init(){\r\n        this._service\r\n            .lista()\r\n            .then(negociacoes => \r\n                        negociacoes.forEach(negociacao => \r\n                            this._listaNegociacoes.adiciona(negociacao)))\r\n            .catch(erro => this._mensagem.texto = erro)\r\n        \r\n        setInterval(() => {\r\n            this.importar()\r\n        }, 3000)\r\n    }\r\n}"]}